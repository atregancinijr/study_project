from matplotlib import pyplot as plt
from scipy.special import erfc
import numpy as np

from matplotlib import rc
rc('font', **{'family':['serif'],'serif':['Helvetica']})
## for Palatino and other serif fonts use:
#rc('font',**{'family':'serif','serif':['Palatino']})
rc('text', usetex=True)

color_list = ['b', 'k', 'r', 'y', 'm', 'k']
marker_list = ['o', 4, 'x', '^', 5, 's']
iteration_list = [1, 2, 3]
code = ['BIBD','Gallager']
SNR_list = np.array([0., 0.55555556, 1.11111111, 1.66666667, 2.22222222,2.77777778, 3.33333333, 3.88888889, 4.44444444, 5., 5.25])
H_list=[0]
H_list_results_iterations = np.array([np.array([[0.07924603174603174, 0.06566666666666666, 0.05302380952380953, 0.04176984126984127, 0.03290476190476191, 0.023253968253968256, 0.015253968253968252, 0.008261904761904762, 0.003373015873015873, 0.0013015873015873015, 0.0007574603174603175],
                                      [0.07832539682539683, 0.06567460317460318, 0.05424603174603174, 0.04221428571428571, 0.03230952380952381, 0.02184920634920635, 0.012484126984126985, 0.005595238095238095, 0.0017142857142857144, 0.00023015873015873014, 9.23015873015873e-05],
                                      [0.08031746031746032, 0.06620634920634921, 0.05463492063492064, 0.04338095238095238, 0.03378571428571429, 0.02207142857142857, 0.011373015873015873, 0.004396825396825397, 0.0007222222222222223, 3.1746031746031745e-05, 9.787936507936508e-06]]),
                                      np.array([[0.07802380952380952, 0.06538888888888889, 0.052658730158730155, 0.04257142857142857, 0.03311111111111111, 0.023492063492063495, 0.01476984126984127, 0.007698412698412697, 0.003944444444444444, 0.0015793650793650793, 0.0008128571428571428],
                                      [0.07707936507936508, 0.06550793650793652, 0.054714285714285715, 0.04286507936507936, 0.03176190476190476, 0.022333333333333334, 0.013730158730158731, 0.006357142857142857, 0.0019761904761904764, 0.00035714285714285714, 0.0001376190476190476],
                                      [0.07970634920634921, 0.06512698412698413, 0.05279365079365079, 0.043515873015873015, 0.03233333333333333, 0.02261111111111111, 0.011825396825396826, 0.004928571428571429, 0.0008412698412698413, 6.349206349206349e-05, 2.015873015873016e-05]])])
plt.figure(figsize = (9.5, 7.5))
plt.ylim(10**-6, 10**-1)
plt.xlim(0-0.01, 5.25+0.025)
plt.xlabel(r'$\textrm{SNR}_{\textrm{dB}}$', fontsize = 16)
plt.ylabel(r'BER', fontsize = 16)

#plt.title("BIBD", y = 1.02)
BER_theory = 0.5 * erfc(np.sqrt(10 ** (np.array(SNR_list) / 10)))
plt.semilogy(SNR_list, BER_theory, '--r', label='Não codificado')

for i, x in enumerate(H_list_results_iterations):
    for j, y in enumerate(x):
        plt.semilogy(SNR_list, y, color=color_list[i], linestyle='-', marker=marker_list[j],
                     label=f'{code[i]} : Iteração = {iteration_list[j]}')
plt.legend(prop={"size":14})
plt.savefig('figure3.pdf', format='pdf', dpi=1000)
plt.show()
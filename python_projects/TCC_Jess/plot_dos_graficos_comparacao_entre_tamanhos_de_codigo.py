from matplotlib import pyplot as plt
from scipy.special import erfc
import numpy as np

from matplotlib import rc
rc('font', **{'family':['serif'],'serif':['Helvetica']})
## for Palatino and other serif fonts use:
#rc('font',**{'family':'serif','serif':['Palatino']})
rc('text', usetex=True)

color_list = ['b', 'k', 'r', 'y', 'm', 'k']
marker_list = ['o', 4, 'x', '^', 5, 's']
iteration_list = [1, 2, 3]
code = ['(529, 462)','(4489, 4158)']
SNR_list = np.array([0., 0.55555556, 1.11111111, 1.66666667, 2.22222222, 2.77777778, 3.33333333, 3.88888889, 4.44444444, 5.0, 5.25])
H_list=[0]
H_list_results_iterations = np.array([np.array([[.07824675324675325, 0.06452813852813853, 0.05271645021645022, 0.039608225108225106, 0.02764069264069264, 0.017246753246753246, 0.0098982683982684, 0.004523809523809524, 0.0018030303030303028, 0.0005822510822510822, 0.00033982683982683985],
                                      [0.07805627705627705, 0.06508225108225109, 0.0518030303030303, 0.03843290043290044, 0.025902597402597403, 0.014471861471861473, 0.005846320346320347, 0.0015173160173160172, 0.0003225108225108225, 3.67965367965368e-05, 8.658008658008659e-06],
                                      [0.07795454545454546, 0.0650021645021645, 0.05179220779220779, 0.038147186147186145, 0.024748917748917746, 0.012660173160173161, 0.004093073593073593, 0.0007575757575757576, 8.008658008658008e-05, 8.484848484848485e-06, 1.948051948051948e-06]]),
                                      np.array([[0.07820586820586821, 0.06506974506974507, 0.05414862914862915, 0.04320827320827321, 0.03404761904761905, 0.02534872534872535, 0.01766233766233766, 0.011041366041366041, 0.005050505050505051, 0.0018710918710918712, 0.0010129870129870129],
                                      [0.07797258297258297, 0.0655074555074555, 0.0539009139009139, 0.043037518037518034, 0.03438191438191438, 0.025016835016835017, 0.01753006253006253, 0.009961519961519961, 0.0028547378547378547, 0.00027417027417027417, 6.277056277056277e-05],
                                      [0.07895382395382396, 0.06548821548821548, 0.05436748436748437, 0.04334535834535834, 0.03401394901394902, 0.025538720538720538, 0.01755892255892256, 0.009095719095719096, 0.001176046176046176, 9.62000962000962e-06, 8.177008177008176e-07]])])
plt.figure(figsize = (9.5, 7.5))
plt.ylim(10**-6, 10**-1)
plt.xlim(0-0.01, 5.25+0.025)
plt.xlabel(r'$\textrm{SNR}_{\textrm{dB}}$', fontsize = 16)
plt.ylabel(r'BER', fontsize = 16)

#plt.title("BIBD", y = 1.02)
BER_theory = 0.5 * erfc(np.sqrt(10 ** (np.array(SNR_list) / 10)))
plt.semilogy(SNR_list, BER_theory, '--r', label='Não codificado')

for i, x in enumerate(H_list_results_iterations):
    for j, y in enumerate(x):
        plt.semilogy(SNR_list, y, color=color_list[i], linestyle='-', marker=marker_list[j],
                     label=f'{code[i]} : Iteração = {iteration_list[j]}')
plt.legend(prop={"size":14})
plt.savefig('figure1.pdf', format='pdf', dpi=1000)
plt.show()